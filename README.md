# Deepfake-Detection
Deepfake-Detection


## Data Preparation
Get the download script [here](https://github.com/ondyari/FaceForensics)
- Download all video with compression rate factor 23
```
python3 download/download-Faceforensics.py ./download -d all -c c23 -t videos
```
The structure of Faceforencsics is as follows


```
├── Faceforensics
    ├── manipulated_sequences
    └── original_sequences
```


## Usage
Set the path in **env.py**
```
DOWNLOAD_DIR: path to Faceforensics/, which contains manipulated_suquences/ and original_sequences/
PREPRO_DIR: empty folder, the folder to save proprocessed data
```

### Data Preprocessing
- Randomly sample 20 pairs of consecutive frames from each video
- Crop face region according to the first frame
```
python3 crop_face.py
```

- Save optical flow generated by different methods (Farneback, FlowNet2.0, SPyNet, PWC-Net) on sampled consecutive image as npy file
  - clone [PWC-Net repository](https://github.com/sniklaus/pytorch-pwc) at root directory and download the pretrained model
  - clone [SPyNet repository](https://github.com/sniklaus/pytorch-spynet) at root directory and download the pretrained model
  - clone [FlowNet2.0 repository](https://github.com/NVIDIA/flownet2-pytorch) at root directory and download the pretrained model
```
python3 save_flow.py
```

